\section{Plots}

In this section, we want to focus on different examples of plots.  We restrict
our presentation to \toolname{pgfplots} because it is the tool we use most;
every example can be done with the other tools, respectively.  The raw data that
is used in the examples can be found in the supplementary GitHub
repository\footnoteref{footnote-github} and on the supplementary web
page\footnoteref{footnote-webpage}.

\subsection{Automatic Generation with \hologo{LuaLaTeX}}

With the \TeX{} engine \hologo{LuaTeX}, which combines \hologo{pdfTeX} with
OpenType and Unicode support, \hologo{METAPOST}, and Lua, it is possible to
generate tables or plots from input data while using a simple scripting
language.  Although this is also possible with plain \TeX{}, it might be more
convenient to program in a scripting language rather than \TeX{}.  The example
in Table~\ref{tab:lualatex-autogenerated} is generated from a CSV file that was
exported by the unit test coverage report of IntelliJ IDEA.

\begin{luacode}
tex.print("\\begin{table}[!t]")
tex.print("\\centering")
tex.print("\\caption{Autogenerated table with \\hologo{LuaLaTeX}}")
tex.print("\\label{tab:lualatex-autogenerated}")
tex.print("\\begin{tabular}{@{}l"
  .. "S[table-format=2.2,round-mode=figures,round-precision=4]r"
  .. "r@{}}")
tex.print("\\textbf{Package} & \\textbf{Line} & \\textbf{\\#} & \\\\\\midrule")

local zeile, daten
for zeile in io.lines("../examples/coverage-unittests-model-line-coverage.csv") do
  daten = fromCSV(zeile)
  local linepercent, linebar, pkgname
  pkgname = daten[1]
  linepercent = string.format("%.2f", daten[6] / daten[7] * 100)
  linebar = tonumber(string.format("%.4f", daten[6] / daten[7]))

  tex.print("" .. pkgname .. "&"
    .. linepercent .. "\\,\\% & (" .. daten[6] .. "/" .. daten[7] .. ")&"
    .. "\\begin{tikzpicture}"
    .. "\\draw [black,thin] (0,0) rectangle (1.0,0.15);"
    .. "\\tikz \\fill [gruen] (0,0) rectangle (" .. linebar .. ",0.15);"
    .. "\\tikz \\fill [rot] (" .. linebar .. ",0) rectangle (1.0,0.15);"
    .. "\\end{tikzpicture}"
    .. "\\\\")
end

tex.print("\\end{tabular}")
tex.print("\\end{table}")
\end{luacode}

Obviously, this data can change during the development of an application; one
does not want to adjust the table by hand, every time the coverage data changes.
Therefore, we simply parse the CSV file and create the table using
\hologo{LuaTeX}.  An example code for doing this, can be found in
Listing~\ref{lst:lua-autofilled-table}.

\begin{listing}[H]
  \inputminted[firstline=22,lastline=54]{latex}{../examples/lua-autofilled-table.tex}
  \caption{Code snippet to automatically generate a table like
    Table~\ref{tab:lualatex-autogenerated} with \hologo{LuaLaTeX}}
  \label{lst:lua-autofilled-table}
\end{listing}
